<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buncha Pricing Model - Meijer Partnership</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .header {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .subtitle {
            color: #666;
            font-size: 18px;
        }
        .controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .control-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .control-item {
            display: flex;
            flex-direction: column;
        }
        label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #333;
        }
        input[type="number"], input[type="range"] {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        .slider-value {
            text-align: right;
            color: #666;
            font-size: 14px;
            margin-top: 5px;
        }
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .card h2 {
            margin-top: 0;
            color: #333;
            font-size: 20px;
        }
        .metric {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        .metric-label {
            color: #666;
        }
        .metric-value {
            font-weight: 600;
            color: #333;
        }
        .option-1 { color: #2563eb; }
        .option-2 { color: #059669; }
        .option-3 { color: #dc2626; }
        .savings { color: #059669; }
        .cost { color: #dc2626; }
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        canvas {
            max-height: 400px;
        }
        .table-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }
        .highlight {
            background: #fef3c7;
            font-weight: 600;
        }
        .best-option {
            background: #d1fae5;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js"></script>
</head>
<body>
    <div class="header">
        <h1>Buncha Economics Model</h1>
        <p class="subtitle">Meijer Partnership Pricing Analysis</p>
    </div>

    <div class="controls">
        <h2>Model Variables</h2>
        <div class="control-group">
            <div class="control-item">
                <label for="competitorPrice">Competitor Price ($/order)</label>
                <input type="number" id="competitorPrice" value="12.99" step="0.01" onchange="updateModel()">
            </div>
            <div class="control-item">
                <label for="storeOrders">Average Store Daily Orders</label>
                <input type="number" id="storeOrders" value="110" step="1" onchange="updateModel()">
            </div>
            <div class="control-item">
                <label for="bunchaCapture">Buncha Market Capture (%)</label>
                <input type="range" id="bunchaCapture" min="30" max="60" value="45" onchange="updateModel()">
                <div class="slider-value"><span id="captureValue">45</span>%</div>
            </div>
            <div class="control-item">
                <label for="rampMonths">Months to Reach 50 Orders/Day</label>
                <input type="range" id="rampMonths" min="2" max="6" value="4" step="0.5" onchange="updateModel()">
                <div class="slider-value"><span id="rampValue">4</span> months</div>
            </div>
            <div class="control-item">
                <label for="numStores">Number of Stores</label>
                <input type="number" id="numStores" value="100" step="10" onchange="updateModel()">
            </div>
        </div>
    </div>

    <div class="dashboard">
        <div class="card">
            <h2>Option 1: Strategic Investment</h2>
            <div class="metric">
                <span class="metric-label">Upfront Investment</span>
                <span class="metric-value cost">$5,500,000</span>
            </div>
            <div class="metric">
                <span class="metric-label">Price per Order</span>
                <span class="metric-value option-1">$9.99</span>
            </div>
            <div class="metric">
                <span class="metric-label">Year 1 Cost (100 stores)</span>
                <span class="metric-value" id="option1Year1">-</span>
            </div>
            <div class="metric">
                <span class="metric-label">Payback Period</span>
                <span class="metric-value" id="option1Payback">-</span>
            </div>
            <div class="metric highlight">
                <span class="metric-label">2-Year Savings vs Competitor</span>
                <span class="metric-value savings" id="option1Savings">-</span>
            </div>
        </div>

        <div class="card">
            <h2>Option 2: Kickstart Guarantee</h2>
            <div class="metric">
                <span class="metric-label">Daily Guarantee</span>
                <span class="metric-value">$450/day (120 days)</span>
            </div>
            <div class="metric">
                <span class="metric-label">After 30 Orders/Day</span>
                <span class="metric-value option-2">$9.99/order</span>
            </div>
            <div class="metric">
                <span class="metric-label">Year 1 Cost (100 stores)</span>
                <span class="metric-value" id="option2Year1">-</span>
            </div>
            <div class="metric">
                <span class="metric-label">Guarantee Cost per Store</span>
                <span class="metric-value cost">$54,000</span>
            </div>
            <div class="metric highlight">
                <span class="metric-label">2-Year Savings vs Competitor</span>
                <span class="metric-value savings" id="option2Savings">-</span>
            </div>
        </div>

        <div class="card">
            <h2>Option 3: Volume Tiers</h2>
            <div class="metric">
                <span class="metric-label">Tier 1 (0-29 orders)</span>
                <span class="metric-value">$13.99/order</span>
            </div>
            <div class="metric">
                <span class="metric-label">Tier 2 (30-44 orders)</span>
                <span class="metric-value">$12.99/order</span>
            </div>
            <div class="metric">
                <span class="metric-label">Tier 3 (45+ orders)</span>
                <span class="metric-value option-3">$10.99/order</span>
            </div>
            <div class="metric">
                <span class="metric-label">Year 1 Cost (100 stores)</span>
                <span class="metric-value" id="option3Year1">-</span>
            </div>
            <div class="metric highlight">
                <span class="metric-label">2-Year Savings vs Competitor</span>
                <span class="metric-value" id="option3Savings">-</span>
            </div>
        </div>
    </div>

    <div class="chart-container">
        <h2>Cumulative Cost Comparison (Portfolio)</h2>
        <canvas id="costChart"></canvas>
    </div>

    <div class="chart-container">
        <h2>Monthly Order Volume Ramp (Per Store)</h2>
        <canvas id="rampChart"></canvas>
    </div>

    <div class="table-container">
        <h2>Detailed Monthly Breakdown (Per Store)</h2>
        <table id="monthlyTable">
            <thead>
                <tr>
                    <th>Month</th>
                    <th>Daily Orders</th>
                    <th>Option 1 Cost</th>
                    <th>Option 2 Cost</th>
                    <th>Option 3 Cost</th>
                    <th>Competitor Cost</th>
                    <th>Best Option</th>
                </tr>
            </thead>
            <tbody id="monthlyTableBody">
            </tbody>
        </table>
    </div>

    <script>
        let costChart, rampChart;

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function calculateRamp(month, targetOrders, rampMonths) {
            if (month >= rampMonths) return targetOrders;
            return Math.round(targetOrders * (month / rampMonths));
        }

        function getOption3Price(orders) {
            if (orders < 30) return 13.99;
            if (orders < 45) return 12.99;
            return 10.99;
        }

        function updateModel() {
            const competitorPrice = parseFloat(document.getElementById('competitorPrice').value);
            const storeOrders = parseInt(document.getElementById('storeOrders').value);
            const bunchaCapture = parseInt(document.getElementById('bunchaCapture').value) / 100;
            const rampMonths = parseFloat(document.getElementById('rampMonths').value);
            const numStores = parseInt(document.getElementById('numStores').value);

            // Update slider values
            document.getElementById('captureValue').textContent = Math.round(bunchaCapture * 100);
            document.getElementById('rampValue').textContent = rampMonths;

            const targetDailyOrders = Math.round(storeOrders * bunchaCapture);
            const months = 24;
            
            // Calculate monthly data
            let monthlyData = [];
            let option1Total = 5500000; // Initial investment
            let option2Total = 0;
            let option3Total = 0;
            let competitorTotal = 0;

            for (let month = 1; month <= months; month++) {
                const dailyOrders = calculateRamp(month, targetDailyOrders, rampMonths);
                const monthlyOrders = dailyOrders * 30;

                // Option 1: Flat $9.99
                const option1Cost = monthlyOrders * 9.99 * numStores;
                option1Total += option1Cost;

                // Option 2: Guarantee then $9.99
                let option2Cost;
                if (month <= 4 && dailyOrders < 30) {
                    option2Cost = 450 * 30 * numStores; // Daily guarantee
                } else {
                    option2Cost = monthlyOrders * 9.99 * numStores;
                }
                option2Total += option2Cost;

                // Option 3: Tiered pricing
                const option3Price = getOption3Price(dailyOrders);
                const option3Cost = monthlyOrders * option3Price * numStores;
                option3Total += option3Cost;

                // Competitor
                const competitorCost = monthlyOrders * competitorPrice * numStores;
                competitorTotal += competitorCost;

                monthlyData.push({
                    month,
                    dailyOrders,
                    option1Cost: option1Cost / numStores,
                    option2Cost: option2Cost / numStores,
                    option3Cost: option3Cost / numStores,
                    competitorCost: competitorCost / numStores,
                    option1Total,
                    option2Total,
                    option3Total,
                    competitorTotal
                });
            }

            // Update summary cards
            const year1Data = monthlyData[11];
            document.getElementById('option1Year1').textContent = formatCurrency(year1Data.option1Total);
            document.getElementById('option2Year1').textContent = formatCurrency(year1Data.option2Total);
            document.getElementById('option3Year1').textContent = formatCurrency(year1Data.option3Total);

            // Calculate savings vs competitor at 2 years
            const year2Data = monthlyData[23];
            const option1Savings = year2Data.competitorTotal - year2Data.option1Total;
            const option2Savings = year2Data.competitorTotal - year2Data.option2Total;
            const option3Savings = year2Data.competitorTotal - year2Data.option3Total;

            document.getElementById('option1Savings').textContent = formatCurrency(option1Savings);
            document.getElementById('option2Savings').textContent = formatCurrency(option2Savings);
            document.getElementById('option3Savings').textContent = formatCurrency(option3Savings);

            // Calculate payback for Option 1
            let paybackMonth = null;
            for (let i = 0; i < monthlyData.length; i++) {
                if (monthlyData[i].competitorTotal > monthlyData[i].option1Total) {
                    paybackMonth = i + 1;
                    break;
                }
            }
            document.getElementById('option1Payback').textContent = paybackMonth ? `${paybackMonth} months` : 'Beyond 24 months';

            // Update charts
            updateCharts(monthlyData);
            updateTable(monthlyData.slice(0, 12)); // Show first year
        }

        function updateCharts(data) {
            // Cost comparison chart
            const ctx1 = document.getElementById('costChart').getContext('2d');
            
            if (costChart) costChart.destroy();
            
            costChart = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: data.map(d => `Month ${d.month}`),
                    datasets: [
                        {
                            label: 'Option 1: Strategic Investment',
                            data: data.map(d => d.option1Total),
                            borderColor: '#2563eb',
                            backgroundColor: 'rgba(37, 99, 235, 0.1)',
                            tension: 0.1
                        },
                        {
                            label: 'Option 2: Kickstart Guarantee',
                            data: data.map(d => d.option2Total),
                            borderColor: '#059669',
                            backgroundColor: 'rgba(5, 150, 105, 0.1)',
                            tension: 0.1
                        },
                        {
                            label: 'Option 3: Volume Tiers',
                            data: data.map(d => d.option3Total),
                            borderColor: '#dc2626',
                            backgroundColor: 'rgba(220, 38, 38, 0.1)',
                            tension: 0.1
                        },
                        {
                            label: 'Competitor Baseline',
                            data: data.map(d => d.competitorTotal),
                            borderColor: '#6b7280',
                            borderDash: [5, 5],
                            tension: 0.1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + formatCurrency(context.parsed.y);
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            ticks: {
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    }
                }
            });

            // Ramp chart
            const ctx2 = document.getElementById('rampChart').getContext('2d');
            
            if (rampChart) rampChart.destroy();
            
            rampChart = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: data.slice(0, 12).map(d => `Month ${d.month}`),
                    datasets: [{
                        label: 'Daily Orders per Store',
                        data: data.slice(0, 12).map(d => d.dailyOrders),
                        backgroundColor: '#3b82f6',
                        borderColor: '#2563eb',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function updateTable(data) {
            const tbody = document.getElementById('monthlyTableBody');
            tbody.innerHTML = '';

            data.forEach(row => {
                const costs = [
                    { name: 'Option 1', cost: row.option1Cost },
                    { name: 'Option 2', cost: row.option2Cost },
                    { name: 'Option 3', cost: row.option3Cost }
                ];
                const bestOption = costs.reduce((min, curr) => curr.cost < min.cost ? curr : min);

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>Month ${row.month}</td>
                    <td>${row.dailyOrders}</td>
                    <td class="${bestOption.name === 'Option 1' ? 'best-option' : ''}">${formatCurrency(row.option1Cost)}</td>
                    <td class="${bestOption.name === 'Option 2' ? 'best-option' : ''}">${formatCurrency(row.option2Cost)}</td>
                    <td class="${bestOption.name === 'Option 3' ? 'best-option' : ''}">${formatCurrency(row.option3Cost)}</td>
                    <td>${formatCurrency(row.competitorCost)}</td>
                    <td>${bestOption.name}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Initialize on load
        updateModel();
    </script>
</body>
</html>